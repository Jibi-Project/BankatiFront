<app-header (toggleSidebarForMe)="sidenav.toggle()"></app-header>
<mat-sidenav-container class="sidenav-container">
  <!-- Sidebar -->
  <mat-sidenav #sidenav mode="side" opened>
    <app-sidenav></app-sidenav>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content>
    <div class="abonnements-container">
      <h1>Abonnements</h1>

      <!-- Add Subscription Form -->
      <mat-card class="abonnement-card">
        <form [formGroup]="abonnementForm" (ngSubmit)="submitAbonnement()" class="form-layout">
          <!-- Nom Service Dropdown -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Nom Service</mat-label>
            <mat-select formControlName="serviceName" placeholder="Choisissez un service" required>
              <mat-option value="Orange">Orange</mat-option>
              <mat-option value="Inwi">Inwi</mat-option>
              <mat-option value="Maroc Telecom">Maroc Telecom</mat-option>
            </mat-select>
            <mat-error *ngIf="abonnementForm.get('serviceName')?.hasError('required')">
              Ce champ est obligatoire.
            </mat-error>
          </mat-form-field>

          <!-- Montant -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Montant</mat-label>
            <input matInput type="number" formControlName="amount" placeholder="Entrez le montant" />
            <mat-error *ngIf="abonnementForm.get('amount')?.hasError('required')">
              Ce champ est obligatoire.
            </mat-error>
            <mat-error *ngIf="abonnementForm.get('amount')?.hasError('min')">
              Le montant doit être supérieur à 0.
            </mat-error>
          </mat-form-field>

          <!-- Fréquence -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Fréquence</mat-label>
            <mat-select formControlName="frequency" placeholder="Sélectionnez une fréquence" required>
              <mat-option value="Mensuel">Mensuel</mat-option>
              <mat-option value="Hebdomadaire">Hebdomadaire</mat-option>
              <mat-option value="Quotidien">Quotidien</mat-option>
            </mat-select>
            <mat-error *ngIf="abonnementForm.get('frequency')?.hasError('required')">
              Ce champ est obligatoire.
            </mat-error>
          </mat-form-field>

          <!-- Date de Début -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Date de Début</mat-label>
            <input matInput type="date" formControlName="startDate" />
            <mat-error *ngIf="abonnementForm.get('startDate')?.hasError('required')">
              Ce champ est obligatoire.
            </mat-error>
          </mat-form-field>

          <!-- Date de Fin -->
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Date de Fin</mat-label>
            <input matInput type="date" formControlName="endDate" />
            <mat-error *ngIf="abonnementForm.get('endDate')?.hasError('required')">
              La date de fin est obligatoire.
            </mat-error>
          </mat-form-field>

          <!-- Submit and Cancel Buttons -->
          <div class="form-actions">
            <button mat-raised-button class="soumettre-button" type="submit" [disabled]="abonnementForm.invalid">
              Soumettre
            </button>
            <button mat-raised-button color="warn" type="button" (click)="cancelAbonnement()">Annuler</button>
          </div>
        </form>
      </mat-card>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
